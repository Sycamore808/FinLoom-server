# FinLoom API数据流程图

## 📊 完整系统架构图

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          前端 Vue3 应用层                                │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │仪表盘    │  │投资组合  │  │回测页面  │  │市场分析  │  │AI对话    │ │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘ │
│       │             │             │             │             │        │
│       └─────────────┴─────────────┴─────────────┴─────────────┘        │
│                              │ api.js                                  │
└──────────────────────────────┼──────────────────────────────────────────┘
                               │ HTTP REST API
┌──────────────────────────────┼──────────────────────────────────────────┐
│                    主服务器 main.py (FastAPI)                            │
│  ┌────────────────────────────────────────────────────────────────────┐│
│  │                      API路由层                                      ││
│  │  /health  /v1/ai/chat  /v1/backtest  /v1/market  /v1/dashboard    ││
│  └───┬────────┬──────────┬──────────┬───────────┬───────────┬─────────┘│
└──────┼────────┼──────────┼──────────┼───────────┼───────────┼──────────┘
       │        │          │          │           │           │
       │        │          │          │           │           │
┌──────▼────┐ ┌▼────────┐┌▼────────┐┌▼─────────┐┌▼─────────┐┌▼──────────┐
│Module 06  │ │Module 10││Module 09││Module 04 ││Module 05 ││Module 01  │
│监控告警   │ │AI交互   ││回测     ││市场分析  ││风险管理  ││数据管道   │
│           │ │         ││         ││          ││          ││           │
│健康检查   │ │对话管理 ││回测引擎 ││情感分析  ││风险分析  ││数据采集   │
│系统监控   │ │需求解析 ││绩效分析 ││异常检测  ││组合优化  ││数据存储   │
│告警管理   │ │推荐引擎 ││走查分析 ││相关性    ││止损策略  ││实时数据   │
└───────────┘ └───┬─────┘└─────┬───┘└──────────┘└──────────┘└───────────┘
                  │            │
                  │调用        │调用
           ┌──────┼────────────┼──────────┐
           │      │            │          │
       ┌───▼───┐┌─▼──────┐ ┌──▼────┐ ┌───▼──────┐
       │Mod 02 ││Mod 03  │ │Mod 07 │ │Module 11 │
       │特征   ││AI模型  │ │优化   │ │可视化    │
       │工程   ││        │ │       │ │          │
       │       ││LSTM/GRU│ │贝叶斯 │ │图表生成  │
       │技术   ││DQN/PPO │ │遗传   │ │报告生成  │
       │指标   ││        │ │网格   │ │仪表板    │
       └───────┘└────────┘ └───────┘ └──────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                          数据存储层 (SQLite)                             │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐     │
│  │finloom.db│ │module02  │ │module04  │ │module09  │ │module10  │ ... │
│  │股票数据  │ │特征数据  │ │分析结果  │ │回测结果  │ │对话记录  │     │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘     │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🔄 核心业务流程图

### 1. AI对话生成投资策略流程

```
┌─────────┐
│用户输入 │  "我想投资100万，风险适中，期限3年"
└────┬────┘
     │ api.chat.aiChat(text, amount, riskTolerance)
     ▼
┌─────────────────────────────────────────────┐
│  main.py: POST /v1/ai/chat                  │
└─────────────┬───────────────────────────────┘
              │
              ▼
┌──────────────────────────────────────────────────────────┐
│ Module 10: DialogueManager.process_user_input()          │
│ ┌──────────────────────────────────────────────────────┐│
│ │ 1. NLPProcessor                                      ││
│ │    ├─ 分词: ["我", "想", "投资", "100万", ...]      ││
│ │    ├─ 实体识别: MONEY=1000000, PERCENT=...          ││
│ │    └─ 情感分析: 中性                                 ││
│ └──────────────────────────────────────────────────────┘│
│ ┌──────────────────────────────────────────────────────┐│
│ │ 2. IntentClassifier                                  ││
│ │    └─ 意图: create_strategy (置信度: 0.9)           ││
│ └──────────────────────────────────────────────────────┘│
│ ┌──────────────────────────────────────────────────────┐│
│ │ 3. RequirementParser                                 ││
│ │    ├─ investment_amount: 1000000                    ││
│ │    ├─ risk_tolerance: MODERATE                      ││
│ │    ├─ investment_horizon: LONG_TERM                 ││
│ │    └─ target_return: None (需澄清)                  ││
│ └──────────────────────────────────────────────────────┘│
└─────────────┬────────────────────────────────────────────┘
              │
              ▼
┌──────────────────────────────────────────────────────────┐
│ Module 10: ParameterMapper.map_to_system_parameters()    │
│ ┌──────────────────────────────────────────────────────┐│
│ │ risk_params: {                                       ││
│ │   max_drawdown: 0.15,                                ││
│ │   position_limit: 0.10,                              ││
│ │   stop_loss: 0.05                                    ││
│ │ }                                                    ││
│ │                                                      ││
│ │ strategy_params: {                                   ││
│ │   investment_style: "balanced",                      ││
│ │   rebalance_frequency: "quarterly"                   ││
│ │ }                                                    ││
│ └──────────────────────────────────────────────────────┘│
└─────────────┬────────────────────────────────────────────┘
              │
              ▼
┌──────────────────────────────────────────────────────────┐
│ Module 10: RecommendationEngine.generate_portfolio...()  │
│                                                           │
│  ┌──────────────────┐                                    │
│  │调用 Module 01    │ 获取股票列表、历史数据             │
│  └────────┬─────────┘                                    │
│           │                                               │
│  ┌────────▼─────────┐                                    │
│  │调用 Module 04    │ 获取市场状态、情感分析             │
│  └────────┬─────────┘                                    │
│           │                                               │
│  ┌────────▼─────────┐                                    │
│  │调用 Module 05    │ 评估风险、计算最优权重             │
│  └────────┬─────────┘                                    │
│           │                                               │
│  ┌────────▼─────────┐                                    │
│  │生成推荐方案      │                                    │
│  │                  │                                    │
│  │ 推荐1: 价值稳健型 (适合度: 0.85)                      │
│  │   - 权重: 银行30%, 消费30%, 医药20%, 债券20%         │
│  │   - 预期收益: 12%/年                                  │
│  │   - 预期波动: 15%                                     │
│  │   - VaR(95%): -8%                                     │
│  │                                                       │
│  │ 推荐2: 均衡成长型 (适合度: 0.78)                      │
│  │   ...                                                 │
│  │                                                       │
│  │ 推荐3: 科技增长型 (适合度: 0.65)                      │
│  │   ...                                                 │
│  └───────────────────┘                                   │
└─────────────┬────────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────────────────────┐
│ Module 10: 保存到数据库                                  │
│   ├─ user_requirements表                                │
│   ├─ strategy_recommendations表                         │
│   └─ dialogue_sessions表                                │
└─────────────┬───────────────────────────────────────────┘
              │
              ▼ 返回JSON响应
┌─────────────────────────────────────────────────────────┐
│ 前端接收推荐                                             │
│ {                                                        │
│   "success": true,                                       │
│   "recommendations": [                                   │
│     {                                                    │
│       "name": "价值稳健型",                              │
│       "suitability_score": 0.85,                         │
│       "asset_allocation": {...},                         │
│       "expected_metrics": {...}                          │
│     },                                                   │
│     ...                                                  │
│   ],                                                     │
│   "session_id": "session_123"                            │
│ }                                                        │
└─────────────────────────────────────────────────────────┘
```

---

### 2. 回测执行完整流程

```
┌─────────┐
│用户提交 │  回测参数
└────┬────┘
     │ api.backtest.run({symbols, dates, strategy})
     ▼
┌─────────────────────────────────────────────┐
│  main.py: POST /v1/backtest/run             │
└─────────────┬───────────────────────────────┘
              │
              ▼
┌──────────────────────────────────────────────────────────┐
│ Module 01: 获取历史数据                                   │
│                                                           │
│  AkshareDataCollector.fetch_stock_history()              │
│  ├─ 000001 (平安银行): 2023-01-01 ~ 2024-12-31          │
│  ├─ 600036 (招商银行): 2023-01-01 ~ 2024-12-31          │
│  └─ 保存到 finloom.db                                    │
│                                                           │
│  返回: {                                                  │
│    '000001': DataFrame[日期, 开盘, 收盘, 最高, 最低, 成交量]│
│    '600036': DataFrame[...]                              │
│  }                                                        │
└─────────────┬────────────────────────────────────────────┘
              │
              ▼
┌──────────────────────────────────────────────────────────┐
│ Module 02: 计算技术指标 (可选)                            │
│                                                           │
│  TechnicalIndicators.calculate_all_indicators()          │
│  ├─ 计算MA(5, 10, 20, 60)                                │
│  ├─ 计算RSI(14)                                          │
│  ├─ 计算MACD(12, 26, 9)                                  │
│  ├─ 计算布林带                                            │
│  └─ 保存到 module02_features.db                          │
│                                                           │
│  返回: {                                                  │
│    '000001': DataFrame[日期, MA5, MA10, RSI, MACD, ...]  │
│    '600036': DataFrame[...]                              │
│  }                                                        │
└─────────────┬────────────────────────────────────────────┘
              │
              ▼
┌──────────────────────────────────────────────────────────┐
│ Module 09: BacktestEngine - 回测执行                      │
│                                                           │
│ ┌──────────────────────────────────────────────────────┐│
│ │ 1. 初始化                                            ││
│ │    ├─ initial_capital: 1,000,000                    ││
│ │    ├─ commission_rate: 0.0003                       ││
│ │    └─ slippage: 0.001                               ││
│ └──────────────────────────────────────────────────────┘│
│                                                           │
│ ┌──────────────────────────────────────────────────────┐│
│ │ 2. 加载策略 (MA均线交叉策略)                         ││
│ │    ├─ 买入条件: MA5上穿MA20                         ││
│ │    └─ 卖出条件: MA5下穿MA20                         ││
│ └──────────────────────────────────────────────────────┘│
│                                                           │
│ ┌──────────────────────────────────────────────────────┐│
│ │ 3. 逐日回测循环                                      ││
│ │                                                      ││
│ │   ┌────────────────────────────────────────────┐   ││
│ │   │ 日期: 2023-01-05                           │   ││
│ │   │  ├─ 生成信号: Module 08.SignalGenerator    │   ││
│ │   │  │  └─ 000001: BUY (MA5上穿MA20)          │   ││
│ │   │  ├─ 风险检查: Module 05.SignalFilter       │   ││
│ │   │  │  └─ 检查仓位限制、止损条件              │   ││
│ │   │  ├─ 生成订单: Module 08.OrderManager       │   ││
│ │   │  │  └─ 买入000001, 数量1000股             │   ││
│ │   │  └─ 模拟成交: TransactionSimulator         │   ││
│ │   │     └─ 成交价: 10.52, 手续费: 3.16        │   ││
│ │   └────────────────────────────────────────────┘   ││
│ │                                                      ││
│ │   ┌────────────────────────────────────────────┐   ││
│ │   │ 日期: 2023-02-10                           │   ││
│ │   │  └─ 生成信号: SELL (MA5下穿MA20)          │   ││
│ │   │     └─ 卖出000001, 数量1000股              │   ││
│ │   └────────────────────────────────────────────┘   ││
│ │                                                      ││
│ │   ... (遍历所有交易日)                               ││
│ │                                                      ││
│ └──────────────────────────────────────────────────────┘│
│                                                           │
│ ┌──────────────────────────────────────────────────────┐│
│ │ 4. 保存交易记录                                      ││
│ │    └─ 保存到 module09_backtest.db                   ││
│ │       ├─ backtest_results表                         ││
│ │       └─ trade_records表                            ││
│ └──────────────────────────────────────────────────────┘│
└─────────────┬────────────────────────────────────────────┘
              │
              ▼
┌──────────────────────────────────────────────────────────┐
│ Module 09: PerformanceAnalyzer - 绩效分析                 │
│                                                           │
│  计算指标:                                                │
│  ├─ 总收益率: 25.3%                                      │
│  ├─ 年化收益率: 12.1%                                    │
│  ├─ 最大回撤: -15.2%                                     │
│  ├─ 夏普比率: 1.45                                       │
│  ├─ 索提诺比率: 1.89                                     │
│  ├─ 盈亏比: 2.3                                          │
│  ├─ 胜率: 58%                                            │
│  ├─ 总交易次数: 45                                       │
│  └─ 保存到 module09_backtest.db                          │
└─────────────┬────────────────────────────────────────────┘
              │
              ▼
┌──────────────────────────────────────────────────────────┐
│ Module 11: ReportBuilder - 生成报告                       │
│                                                           │
│  generate_performance_report()                           │
│  ├─ 生成JSON报告                                         │
│  │  └─ 保存到 reports/backtest_report_20250108.json     │
│  ├─ 生成Excel报告 (可选)                                 │
│  │  └─ 保存到 reports/backtest_report_20250108.xlsx     │
│  └─ 保存到 module11_visualization.db                     │
│                                                           │
│  报告内容:                                                │
│  {                                                        │
│    "metadata": {...},                                    │
│    "summary": {                                          │
│      "total_return": 0.253,                              │
│      "sharpe_ratio": 1.45,                               │
│      "max_drawdown": -0.152                              │
│    },                                                    │
│    "trades": [...],                                      │
│    "equity_curve": [...]                                 │
│  }                                                        │
└─────────────┬────────────────────────────────────────────┘
              │
              ▼ 返回JSON响应
┌─────────────────────────────────────────────────────────┐
│ 前端接收回测结果                                         │
│ {                                                        │
│   "success": true,                                       │
│   "backtest_id": "backtest_20250108_143025",             │
│   "result": {                                            │
│     "total_return": 0.253,                               │
│     "sharpe_ratio": 1.45,                                │
│     "max_drawdown": -0.152,                              │
│     "trades": [...]                                      │
│   },                                                     │
│   "report_path": "reports/backtest_report_20250108.json" │
│ }                                                        │
│                                                          │
│ 前端展示:                                                │
│  ├─ 收益曲线图表                                         │
│  ├─ 回撤图表                                             │
│  ├─ 交易记录表格                                         │
│  └─ 绩效指标卡片                                         │
└─────────────────────────────────────────────────────────┘
```

---

### 3. 市场分析流程

```
┌─────────┐
│用户请求 │  市场情感分析
└────┬────┘
     │ api.market.analysis.analyzeSentiment({symbol: "000001"})
     ▼
┌─────────────────────────────────────────────┐
│  main.py: POST /v1/analysis/sentiment       │
└─────────────┬───────────────────────────────┘
              │
              ▼
┌──────────────────────────────────────────────────────────┐
│ Module 04: FINR1SentimentAnalyzer.analyze_stock_...()    │
│                                                           │
│ ┌──────────────────────────────────────────────────────┐│
│ │ 1. 获取新闻数据                                      ││
│ │    └─ Module 01: ChineseAlternativeDataCollector    ││
│ │       └─ fetch_stock_news(symbol="000001")          ││
│ │          返回: 最近30天新闻列表                      ││
│ └──────────────────────────────────────────────────────┘│
│                                                           │
│ ┌──────────────────────────────────────────────────────┐│
│ │ 2. FIN-R1模型分析                                    ││
│ │    对每条新闻:                                        ││
│ │    ├─ 新闻1: "平安银行Q3净利润同比增长15%"           ││
│ │    │  └─ 情感: POSITIVE (0.85)                       ││
│ │    ├─ 新闻2: "监管要求加强风险管控"                  ││
│ │    │  └─ 情感: NEGATIVE (0.65)                       ││
│ │    └─ 新闻3: "推出创新金融产品"                      ││
│ │       └─ 情感: POSITIVE (0.72)                       ││
│ └──────────────────────────────────────────────────────┘│
│                                                           │
│ ┌──────────────────────────────────────────────────────┐│
│ │ 3. 聚合分析                                          ││
│ │    └─ MarketSentimentAggregator                      ││
│ │       ├─ 整体情感: POSITIVE                          ││
│ │       ├─ 情感得分: 0.68                              ││
│ │       ├─ 正面新闻占比: 65%                           ││
│ │       ├─ 情感趋势: 上升                              ││
│ │       └─ 置信度: 0.78                                ││
│ └──────────────────────────────────────────────────────┘│
│                                                           │
│ ┌──────────────────────────────────────────────────────┐│
│ │ 4. 保存分析结果                                      ││
│ │    └─ 保存到 module04_market_analysis.db             ││
│ │       └─ sentiment_analysis表                        ││
│ └──────────────────────────────────────────────────────┘│
└─────────────┬────────────────────────────────────────────┘
              │
              ▼ 返回JSON响应
┌─────────────────────────────────────────────────────────┐
│ 前端接收分析结果                                         │
│ {                                                        │
│   "success": true,                                       │
│   "symbol": "000001",                                    │
│   "overall_sentiment": "POSITIVE",                       │
│   "sentiment_score": 0.68,                               │
│   "confidence": 0.78,                                    │
│   "positive_ratio": 0.65,                                │
│   "trend": "上升",                                       │
│   "news_analyzed": 30,                                   │
│   "details": [...]                                       │
│ }                                                        │
│                                                          │
│ 前端展示:                                                │
│  ├─ 情感得分仪表盘 (0.68/1.0)                            │
│  ├─ 正负面新闻占比饼图                                   │
│  ├─ 情感趋势折线图                                       │
│  └─ 新闻列表 (标注情感标签)                              │
└─────────────────────────────────────────────────────────┘
```

---

## 📊 数据流向图

### 数据流向总览

```
┌─────────────────────────────────────────────────────────────┐
│                      外部数据源                              │
│  AKShare │ 新闻API │ 财经数据API │ 交易所API                 │
└─────────────┬───────────────────────────────────────────────┘
              │ 采集
              ▼
┌──────────────────────────────────────────────────────────────┐
│ Module 01: 数据管道                                           │
│  ├─ 股票行情 (日线/分时)                                      │
│  ├─ 财务数据 (资产负债表/利润表/现金流)                      │
│  ├─ 宏观数据 (GDP/CPI/PMI)                                   │
│  ├─ 新闻数据                                                  │
│  └─ 板块数据                                                  │
│                                                               │
│  存储: finloom.db                                             │
└─────┬────────────────────────────────────────────────────────┘
      │ 原始数据
      │
      ├───────────────┬────────────────┬───────────────┬─────────
      │               │                │               │
      ▼               ▼                ▼               ▼
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│Module 02 │    │Module 03 │    │Module 04 │    │Module 05 │
│特征工程  │    │AI模型    │    │市场分析  │    │风险管理  │
│          │    │          │    │          │    │          │
│计算指标  │    │训练模型  │    │情感分析  │    │风险计算  │
│MA/RSI/   │    │LSTM/DQN  │    │异常检测  │    │VaR计算   │
│MACD/布林 │    │预测价格  │    │相关性    │    │止损判断  │
│          │    │          │    │状态识别  │    │          │
│存储:     │    │存储:     │    │存储:     │    │存储:     │
│module02  │    │module03  │    │module04  │    │module05  │
│features  │    │ai_models │    │analysis  │    │risk      │
└─────┬────┘    └─────┬────┘    └─────┬────┘    └─────┬────┘
      │               │               │               │
      │特征          │预测           │分析           │风险
      │               │               │               │
      └───────────────┴───────────────┴───────────────┘
                      │ 综合信息
                      ▼
      ┌───────────────────────────────────────────────┐
      │          Module 08: 交易执行                   │
      │                                                │
      │  信号生成 → 风险过滤 → 订单管理 → 执行监控   │
      │                                                │
      │  存储: module08_execution.db                   │
      └───────────────┬───────────────────────────────┘
                      │ 交易记录
                      ▼
      ┌───────────────────────────────────────────────┐
      │          Module 09: 回测验证                   │
      │                                                │
      │  历史模拟 → 绩效分析 → 风险归因 → 走查分析   │
      │                                                │
      │  存储: module09_backtest.db                    │
      └───────────────┬───────────────────────────────┘
                      │ 回测结果
                      ▼
      ┌───────────────────────────────────────────────┐
      │          Module 11: 可视化                     │
      │                                                │
      │  图表生成 → 报告生成 → 仪表板 → 数据导出     │
      │                                                │
      │  存储: module11_visualization.db               │
      │  输出: HTML/JSON/Excel/PDF报告                 │
      └───────────────┬───────────────────────────────┘
                      │ 可视化结果
                      ▼
      ┌───────────────────────────────────────────────┐
      │              前端展示                          │
      │                                                │
      │  图表 │ 表格 │ 仪表盘 │ 报告                  │
      └───────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                   Module 10: AI交互 (横跨所有层)             │
│                                                              │
│  对话管理 → 需求解析 → 参数映射 → 模块协调 → 推荐生成      │
│                                                              │
│  调用: Module 01/04/05/07/09/11                              │
│  存储: module10_ai_interaction.db                            │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                 Module 06: 监控告警 (监控所有层)             │
│                                                              │
│  系统监控 → 性能监控 → 告警管理 → 通知推送                  │
│                                                              │
│  监控: 所有模块的健康状态和性能指标                          │
│  存储: module06_monitoring.db                                │
└─────────────────────────────────────────────────────────────┘
```

---

## 🔄 模块间调用关系矩阵

```
调用方/被调用方 │ M01 │ M02 │ M03 │ M04 │ M05 │ M06 │ M07 │ M08 │ M09 │ M10 │ M11 │
──────────────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┤
Module 01     │  -  │     │     │     │     │  ✓  │     │     │     │     │     │
Module 02     │  ✓  │  -  │     │     │     │  ✓  │     │     │     │     │     │
Module 03     │  ✓  │  ✓  │  -  │     │     │  ✓  │     │     │     │     │     │
Module 04     │  ✓  │  ✓  │     │  -  │     │  ✓  │     │     │     │     │     │
Module 05     │  ✓  │  ✓  │     │  ✓  │  -  │  ✓  │     │     │     │     │     │
Module 06     │  ✓  │  ✓  │  ✓  │  ✓  │  ✓  │  -  │  ✓  │  ✓  │  ✓  │  ✓  │  ✓  │
Module 07     │  ✓  │  ✓  │  ✓  │  ✓  │  ✓  │  ✓  │  -  │     │  ✓  │     │     │
Module 08     │  ✓  │  ✓  │  ✓  │  ✓  │  ✓  │  ✓  │     │  -  │     │     │     │
Module 09     │  ✓  │  ✓  │  ✓  │  ✓  │  ✓  │  ✓  │     │  ✓  │  -  │     │  ✓  │
Module 10     │  ✓  │     │     │  ✓  │  ✓  │     │  ✓  │     │  ✓  │  -  │  ✓  │
Module 11     │  ✓  │  ✓  │     │  ✓  │  ✓  │  ✓  │     │     │  ✓  │     │  -  │

说明:
✓ = 该模块会调用被调用方模块的功能
M01 = Module 01 (数据管道)
M02 = Module 02 (特征工程)
...依此类推
```

---

## 🎯 关键数据转换流程

### 原始数据 → 交易决策

```
外部数据源
    ↓
[Module 01] 数据采集
    ├─ 股票价格: [日期, 开, 高, 低, 收, 量]
    ├─ 财务数据: [资产, 负债, 净利润, ...]
    └─ 新闻数据: [标题, 内容, 时间, ...]
    ↓
[Module 02] 特征工程
    ├─ 技术指标: [MA5, MA20, RSI, MACD, ...]
    ├─ 基本面因子: [PE, PB, ROE, ...]
    └─ 情绪因子: [新闻情感, 社交媒体情绪, ...]
    ↓
[Module 03] AI模型预测
    ├─ LSTM预测: 未来5日收盘价预测
    ├─ DQN策略: 买入/持有/卖出动作
    └─ 置信度: 预测可靠性评分
    ↓
[Module 04] 市场分析
    ├─ 市场状态: 牛市/熊市/震荡
    ├─ 异常检测: 是否存在异常波动
    └─ 情感分析: 市场情绪倾向
    ↓
[Module 05] 风险评估
    ├─ VaR计算: 潜在最大损失
    ├─ 仓位建议: 建议持仓比例
    └─ 止损价格: 动态止损位
    ↓
[Module 08] 生成交易信号
    ├─ 信号类型: BUY / SELL / HOLD
    ├─ 信号强度: 0.85
    ├─ 目标价格: 11.50
    └─ 建议数量: 1000股
    ↓
[Module 08] 订单执行
    ├─ 订单类型: 限价单
    ├─ 价格: 11.48
    ├─ 数量: 1000
    └─ 状态: 已成交
    ↓
[Module 09] 记录与回测验证
    └─ 保存交易记录，用于绩效评估
```

---

## 📝 总结

### 核心数据流向

1. **采集层** (Module 01): 从外部获取原始数据
2. **处理层** (Module 02, 03, 04): 数据加工、特征提取、模型预测
3. **决策层** (Module 05, 07, 10): 风险评估、参数优化、策略决策
4. **执行层** (Module 08): 信号生成、订单管理、执行监控
5. **验证层** (Module 09): 回测验证、绩效分析
6. **展示层** (Module 11): 可视化、报告生成
7. **监控层** (Module 06): 全系统监控、告警管理

### 关键接口点

- **前端 ↔ main.py**: REST API接口
- **main.py ↔ 各模块**: Python函数调用
- **模块 ↔ 数据库**: SQLite读写
- **Module 10 ↔ 多模块**: AI交互协调中心

---

**FinLoom量化交易系统 - 数据流程可视化**






